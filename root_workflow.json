{
  "id": "coordinator_workflow",
  "initial": "waiting_for_event",
  "states": {
    "waiting_for_event": {
      "on": {
        "trigger": {
          "target": "select_workflow",
          "actions": {
            "get_available_workflows": {
              "type": "activity"
            }
          }
        }
      }
    },
    "select_workflow": {
      "on": {
        "workflow_selected": {
          "target": "load_definition",
          "actions": {
            "choose_workflow": {
              "type": "activity"
            }
          }
        }
      }
    },
    "load_definition": {
      "on": {
        "definition_loaded": {
          "target": "run_child_workflow",
          "actions": {
            "load_workflow_definition": {
              "type": "activity"
            }
          }
        }
      }
    },
    "run_child_workflow": {
      "invoke": {
        "id": "incident_workflow",
        "src": {
          "id": "incident_workflow",
          "initial": "detecting",
          "states": {
            "detecting": {
              "on": {
                "start_analysis": {
                  "target": "analyzing",
                  "actions": {
                    "detect_incident": {
                      "type": "activity"
                    }
                  }
                }
              }
            },
            "analyzing": {
              "on": {
                "analysis_complete": {
                  "target": "notifying",
                  "actions": {
                    "analyze_logs": {
                      "type": "activity",
                      "timeout_seconds": 120
                    }
                  }
                }
              }
            },
            "notifying": {
              "on": {
                "notification_sent": {
                  "target": "resolving",
                  "actions": {
                    "send_notification": {
                      "type": "activity"
                    }
                  }
                }
              }
            },
            "resolving": {
              "on": {
                "resolution_confirmed": {
                  "target": "done",
                  "actions": {
                    "mark_complete": {
                      "type": "activity"
                    }
                  }
                }
              }
            },
            "done": {
              "type": "final"
            }
          }
        },
        "onDone": {
          "target": "done"
        },
        "onError": {
          "target": "waiting_for_event"
        }
      }
    },
    "done": {
      "type": "final"
    }
  }
}